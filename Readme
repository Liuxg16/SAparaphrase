# Env
python 3.5
nltk
pip3 install python-zpar

# dataset
twitter: https://languagenet.github.io/

# test bert
CUDA_VISIBLE_DEVICES=1 python3 bertinterface.py

# sampling
# hm
python3 source/run.py --no_train  --exps_dir test --exp_name test --gpu 1  --mode mh  --forward_path exps/forward/ckpt/model-best.pkl  --backward_path exps/backward/ckpt/model-best.pkl  --hidden_size 512 --sample_time 100  --search_size 100  --data_path data/quora/test.txt --sim_mode keyword  --save_path log.log  --use_data_path data/input/input.txt --reference_path data/input/refer.txt
# basic sa
python3 source/run.py --data_path data/input/input.txt --use_data_path data/input/test.txt --mode kw-bleu --save_path temp.txt  --N_repeat 1  --save_path temp.txt  --batch_size 1 --gpu 2


# basic sa batch
python3 source/run.py --data_path data/input/input.txt --use_data_path data/input/test.txt --mode kw --save_path temp.txt  --N_repeat 1  --save_path temp.txt  --batch_size 3 --gpu 2
#coco
python3 source-py/run.py --exps_dir exps-sampling --exp_name coco-rep1  --gpu 0  --hidden_size 300 --dropout 0.2 --data_path data/quora/test.txt --emb_size 300 --no_train --mode kw-bleu --forward_path exps/coco-forward/ckpt/model-best.pkl --backward_path exps/coco-backward/ckpt/model-best.pkl --batch_size 1 --use_data_path data/cocodata/cocovalid.txt  --save_path sa.txt --emb_path data/cocodata/emb.pkl --dict_path data/cocodata/dict.pkl --C 0.3  --M_kw 3   --M_bleu 1 --N_repeat 1  

# quora
python source/run.py --data_path data/input/input.txt --use_data_path data/quoradata/test.txt --mode kw-bleu --N_repeat 1 --exps_dir exps-sampling/ --exp_name quora-kw7 --batch_size 1 --gpu 1 --M_kw 7 --search_size 50 --C 0.03

# twitter
python3 source-py/run.py --exps_dir exps-sampling --exp_name twi-rep1  --gpu 0 --hidden_size 300 --dropout 0.2 --data_path data/quora/test.txt --emb_size 300 --no_train --mode kw-bleu --forward_path exps/twi-forward/ckpt/model-best.pkl --backward_path exps/twi-backward/ckpt/model-best.pkl --batch_size 1 --use_data_path data/twitterdata/twitter-test.txt --save_path sa.txt --emb_path data/twitterdata/emb.pkl --dict_path data/twitterdata/dict.pkl --C 0.3 --M_kw 3 --M_bleu 1 --N_repeat 1 



# evaluate
## links
### https://github.com/Maluuba/nlg-eval
python3 source/evaluate.py --reference_path data/quora/test.txt  --generated_path sa-keyword.txt
python source/evaluate.py --reference_path data/cocodata/refer_8479-.txt  --generated_path sa-coco-searchsize50-8479-.txt --mode rouge

nlg-eval --hypothesis=tem.txt --references=sa-coco-searchsize50-8479-.txt
